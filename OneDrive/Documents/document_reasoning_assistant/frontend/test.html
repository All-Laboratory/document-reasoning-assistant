<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Document Reasoning Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">Frontend Test Page</h1>
        
        <div class="space-y-4">
            <div class="bg-white p-4 rounded-lg border">
                <h2 class="font-semibold mb-2">Health Check Test</h2>
                <button id="health-test" class="bg-blue-500 text-white px-4 py-2 rounded">Test Health Endpoint</button>
                <div id="health-result" class="mt-2 p-2 bg-gray-100 rounded hidden"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border">
                <h2 class="font-semibold mb-2">Session Test</h2>
                <button id="session-test" class="bg-green-500 text-white px-4 py-2 rounded">Test Session Creation</button>
                <div id="session-result" class="mt-2 p-2 bg-gray-100 rounded hidden"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border">
                <h2 class="font-semibold mb-2">Console Messages</h2>
                <div id="console-output" class="p-2 bg-gray-900 text-green-400 rounded text-sm font-mono h-40 overflow-y-auto"></div>
            </div>
        </div>
    </div>

    <script>
        // Intercept console messages
        const consoleOutput = document.getElementById('console-output');
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn
        };
        
        function addToConsole(type, ...args) {
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            const div = document.createElement('div');
            div.className = type === 'error' ? 'text-red-400' : 
                           type === 'warn' ? 'text-yellow-400' : 'text-green-400';
            div.textContent = `[${type.toUpperCase()}] ${new Date().toLocaleTimeString()}: ${message}`;
            consoleOutput.appendChild(div);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalConsole.log(...args);
            addToConsole('log', ...args);
        };
        
        console.error = function(...args) {
            originalConsole.error(...args);
            addToConsole('error', ...args);
        };
        
        console.warn = function(...args) {
            originalConsole.warn(...args);
            addToConsole('warn', ...args);
        };
        
        // Test functions
        document.getElementById('health-test').addEventListener('click', async () => {
            const resultDiv = document.getElementById('health-result');
            resultDiv.classList.remove('hidden');
            resultDiv.textContent = 'Testing...';
            
            try {
                console.log('Starting health check test...');
                const response = await fetch('/health');
                console.log('Health check response:', response.status, response.statusText);
                
                const data = await response.json();
                console.log('Health check data:', data);
                
                resultDiv.innerHTML = `
                    <div class="text-green-600">✓ Success</div>
                    <pre class="mt-2 text-xs overflow-x-auto">${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Health check failed:', error);
                resultDiv.innerHTML = `<div class="text-red-600">✗ Error: ${error.message}</div>`;
            }
        });
        
        document.getElementById('session-test').addEventListener('click', async () => {
            const resultDiv = document.getElementById('session-result');
            resultDiv.classList.remove('hidden');
            resultDiv.textContent = 'Testing...';
            
            try {
                console.log('Starting session creation test...');
                const response = await fetch('/session', { method: 'POST' });
                console.log('Session response:', response.status, response.statusText);
                
                const data = await response.json();
                console.log('Session data:', data);
                
                resultDiv.innerHTML = `
                    <div class="text-green-600">✓ Success</div>
                    <pre class="mt-2 text-xs overflow-x-auto">${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Session creation failed:', error);
                resultDiv.innerHTML = `<div class="text-red-600">✗ Error: ${error.message}</div>`;
            }
        });
        
        // Log page load
        console.log('Test page loaded successfully');
        console.log('Location:', window.location.href);
        console.log('User agent:', navigator.userAgent);
    </script>
</body>
</html>
